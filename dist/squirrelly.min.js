!function(e,n){"object"==typeof exports&&"undefined"!=typeof module?n(exports):"function"==typeof define&&define.amd?define(["exports"],n):n((e=e||self).Sqrl={})}(this,(function(e){"use strict";var n={},r={},t=/{{ *?(?:(?:([\w$]+) *?\((.*?)\) *?([\w$]*))|(?:([\w$]+) *?\((.*?)\) *?\/)|(?:([\w$@].*?) *?((?:\| *?[\w$]+ *)*))|(?:\/ *?([\w$]+))|(?:# *?([\w$]+))|(?:!--[^]+?--)) *?}}\n?/g,i=/options.(\w+)/g,l={s:"{{",e:"}}"},a=/@(?:((?:\.\.\/)+)|([\w$]+):)?/g,o=t,s=l;function f(e,n){var r=e+o.source.slice(s.s.length,0-(s.e.length+3))+n+"\\n?",t=o.lastIndex;s={s:e,e:n},(o=RegExp(r,"g")).lastIndex=t}function u(e,n,r){return e.replace(a,(function(e,t,i){return"hvals"+(t&&t.length?n[r-t.length/3-1].id:i||"")+"."}))}var c={if:{helperStart:function(e){return"if("+e+"){"},helperEnd:function(){return"}"},blocks:{else:function(){return"}else{"}}},each:{helperStart:function(e,n){return"for(var i=0;i<"+e+".length; i++){tR+=(function(hvals){var tR='';var hvals"+n+"=hvals;"},helperEnd:function(e){return"return tR})({this:"+e+"[i],index:i})};"}},foreach:{helperStart:function(e,n){return"for(var key in "+e+"){if(!"+e+".hasOwnProperty(key)) continue;tR+=(function(hvals){var tR='';var hvals"+n+"=hvals;"},helperEnd:function(e){return"return tR})({this:"+e+"[key], key: key})};"}},log:{selfClosing:function(e){return"console.log("+e+");"}},tags:{selfClosing:function(e){return f(e.slice(0,e.indexOf(",")).trim(),e.slice(e.indexOf(",")+1).trim()),""}},js:{selfClosing:function(e){return e+";"}}},v={"&":"&amp;","<":"&lt;",'"':"&quot;","'":"&#39;"};function p(e){return v[e]}var d=/[&<"']/g,h=/[&<"']/,g={e:function(e){var n=String(e);return h.test(n)?n.replace(d,p):n}},y={},m={start:"",end:""};var x=!0;function w(e,n){var r,t=!1,i="",l="";if(n&&""!==n){r=n.split("|");for(var a=0;a<r.length;a++)r[a]=r[a].trim(),""!==r[a]&&("safe"!==r[a]?(i="Sqrl.F."+r[a]+"("+i,l+=")"):t=!0)}return i+=m.start,l+=m.end,!t&&x&&(i+="Sqrl.F.e(",l+=")"),i+e+l}function R(e){var n,a=0,f="var tR='';",v=[],p=-1,d=0,h={},g=[];function y(n){a!==n&&(f+="tR+='"+e.slice(a,n).replace(/\\/g,"\\\\").replace(/'/g,"\\'")+"';")}function m(e,n){g.push(e);var r=u(e,v,p);return"@"===e[0]?w(r,n):w("options."+r,n)}for(s=l,(o=t).lastIndex=0;null!==(n=o.exec(e));)if(y(n.index),a=n[0].length+n.index,n[1]){var x=n[3];""!==x&&null!==x||(x=d,d++);var R=c.hasOwnProperty(n[1]);p+=1;var P=n[2]||"";P=u(P,v,p);var S=i.exec(P)[1];g.push(S),R||(P="["+P+"]");var F={name:n[1],id:x,params:P,native:R};v[p]=F,R?(f+=c[n[1]].helperStart(P,x),a=o.lastIndex):f+="tR+=Sqrl.H."+n[1]+"("+P+",function(hvals){var hvals"+x+"=hvals;var tR='';"}else if(n[4]){var O=n[5]||"";if(O=u(O,v,p),"include"===n[4]){var $=e.slice(0,n.index),k=e.slice(n.index+n[0].length),q=O.replace(/'|"/g,""),H=r[q];e=$+H+k,a=o.lastIndex=n.index}else c.hasOwnProperty(n[4])&&c[n[4]].hasOwnProperty("selfClosing")?(f+=c[n[4]].selfClosing(O),a=o.lastIndex):f+="tR+=Sqrl.H."+n[4]+"("+O+");"}else if(n[6])f+="tR+="+m(n[6],n[7])+";";else if(n[8]){var b=v[p];b&&b.name===n[8]?(p-=1,!0===b.native?f+=c[b.name].helperEnd(b.params,b.id):h[b.id]?f+="return tR}});":f+="return tR});"):console.error("Helper beginning & end don't match.")}else if(n[9]){var I=v[p];if(I.native){var C=c[I.name];C.blocks&&C.blocks[n[9]]?(f+=C.blocks[n[9]](I.id),a=o.lastIndex):console.warn("Native helper '%s' doesn't accept that block.",I.name)}else h[I.id]?f+="return tR},"+n[9]+":function(hvals){var hvals"+I.id+"=hvals;var tR='';":(f+="return tR},{"+n[9]+":function(hvals){var hvals"+I.id+"=hvals;var tR='';",h[I.id]=!0)}return y(e.length),f+="return tR",{compile:new Function("options","Sqrl",f.replace(/\n/g,"\\n").replace(/\r/g,"\\r")),tokens:g}}var P={};function S(e,n){var r=e.$file,t=e.$name,i=e.$cache;if(r){var l=require("fs");return!1!==i?(P.hasOwnProperty(r)||(P[r]=R(l.readFileSync(r,"utf8")).compile),P[r]):R(l.readFileSync(r,"utf8")).compile}return"string"==typeof n?t&&!1!==i?(P.hasOwnProperty(t)||(P[t]=R(n).compile),P[t]):!0===i?(P.hasOwnProperty(n)||(P[n]=R(n).compile),P[n]):R(n).compile:t&&!1!==i&&P.hasOwnProperty(t)?P[t]:"No template"}function F(e,t){return t.$file=e,S(t)(t,{H:n,F:g,P:r})}e.Compile=R,e.F=g,e.H=n,e.P=r,e.Render=function(e,t){return"function"==typeof e?e(t,{H:n,F:g,P:r}):"string"==typeof e?S(t,e)(t,{H:n,F:g,P:r}):void 0},e.__express=function(e,n,r){return r(null,F(e,n))},e.autoEscaping=function(e){return x=e},e.defaultTags=function(e){f(e[0],e[1]),t=o,l=s},e.defineFilter=function(e,n){g[e]=n},e.defineHelper=function(e,r){n[e]=r},e.defineNativeHelper=function(e,n){c[e]=n},e.definePartial=function(e,n){r[e]=n},e.load=S,e.renderFile=F,e.setDefaultFilters=function(e){if("clear"===e)y={};else for(var n in e)e.hasOwnProperty(n)&&(y[n]=e[n]);!function(){for(var e in m={start:"",end:""},y)y.hasOwnProperty(e)&&y[e]&&(m.start+="Sqrl.F."+e+"(",m.end+=")")}()},Object.defineProperty(e,"__esModule",{value:!0})}));
//# sourceMappingURL=squirrelly.min.js.map
